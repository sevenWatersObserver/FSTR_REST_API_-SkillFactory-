# REST API для pereval.online (ФСТР)

FSTR_worker - рабочий модуль для осуществления REST API для принятия, хранения и проверки записей о перевалах (местоположении), от пользователей сайта pereval.online и мобильного приложения для ФСТР. Осуществлены 4 функции потребованиям: отправка записи (POST), редактирования записи (PUT), и два метода для получения записи(-ей) по ID записиили по электронной почте пользователя (GET). Для каждой функции этот модуль подключается к базе данных, затем проделывает работу на этой базе, по каждому запросу.

Используются внешние ресурсы: PostgreSQL, FastAPI.

## Содержание

"FSTR_worker.py" - единственный рабочий модуль. 3 другия файла включены для дальнейшей работы, но не обязательны. 

"postgreSQL_FSTR_DB_modified" - PostgreSQL база данных для программы, с некоторыми улучшениями от оригинала.

"MOD_DB_LOGIN.py" - текстовый файл в формате Python - здесь нужно ввести данные для входа в сервер PostgreSQL.

"ex_input.json" - JSON-файл, пример входящего запроса с которым работает этот модуль.

## Инструкция
Желательно установите Python 3.8 - работа с Python 3.10+ не тестировалось, возможно что нужно переписать некоторые места. Далее, установите внешние модули через консоль:
```
pip install psycopg2
pip install fastapi
```
Модуль должен работать как обыкновенный "скрипт". Имеются 4 функции:
```
# Функция для отправления записи
@app.post("/submitData")
def post_entry(user_input):...

# Функция для изменения записи, с ограничениями на новые записи и на неизменность пользователя
@app.put("/submitData/{pereval_id}")
def update_entry(pereval_id, user_input):...

# Функция для получения записи по id
@app.get("/submitData/{pereval_id}")
def get_entry_by_id(pereval_id):...

# Функция для получения записи по эл. почте пользователя
@app.get("/submitData/?user__email=<{user_email}>")
def get_entry_by_email(user_email):...
```
Для местного тестирования и дальнейшей работы, рекомендуется также установить PostgreSQL или какую-либо программу для (симуляции) хостинга, например Uvicorn.

## Лимитации
> Из-за недостаточности системы и хорошего подключения к Интернету, я ещё не провёл полное тестирование с модулем на настоящий сервер, и не провёл работу со Swagger. Работа была, мягко говоря, "вслепую".
> 
> Модуль проделывает прямые, нефильтрированные запросы к базы данных. Я не знаю, насколько это уязвимо к атакам типа SQL-injection, но в задании не было указана защита как требование. Вся эта система предназначена для совместной работы с модерацией, которая, надеюсь, будет работать.
>
> Где-то могут быть очепятки. Я не часто работаю на русском.
>
> -- sevenWatersObserver
